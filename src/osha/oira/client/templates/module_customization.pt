<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:meta="http://xml.zope.org/namespaces/meta"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      meta:interpolation="true"
      i18n:domain="euphorie"
      tal:define="client nocall:request/client; webhelpers nocall:context/@@webhelpers"
      metal:use-macro="context/@@shell/macros/shell">

<body>
<metal:slot fill-slot="content" tal:define="module nocall:view/module">
<article class="rich">
    <h1 i18n:translate="title_other_risks">Other risks</h1>
    <tal:block replace="tile:statusmessages"/>

    <form enctype="multipart/form-data" accept-charset="UTF-8" method="post" action="${context/absolute_url}">

	<fieldset class="custom-risks pat-clone" data-pat-clone="template: #risk-template" tal:define="risks view/get_custom_risks">

        <fieldset class="risk-set clone" tal:repeat="item risks">
            <h2>Risk ${repeat/item/number}</h2>
            <input type="hidden" name="risk.id:utf8:ustring:records" value="${item/id}"/>
            <fieldset class="vertical">
                <textarea autofocus required tal:content="item/title"
                    name="risk.description:utf8:ustring:records" placeholder="Description of risk ${repeat/item/number}" id="description-${repeat/item/number}" cols="30" rows="6" class="description"></textarea>
                <textarea name="risk.comment:utf8:ustring:records" class="span-15" rows="5" tal:content="item/comment"
                    placeholder="Please leave any comments you may have on the question above in this field. These comments will be used in the action plan."
                        i18n:attributes="placeholder label_comment"></textarea>
            </fieldset>
			<label class="priority">This is a
                <select name="risk.priority:utf8:ustring:records">
					<option value="low" tal:attributes="selected python:item.priority == 'low'">
                        <tal:span i18n:translate="priority_low_risk">low priority risk</tal:span>
					</option>
					<option value="medium" tal:attributes="selected python:item.priority == 'medium'">
                        <tal:span i18n:translate="priority_medium_risk">medium priority risk</tal:span>
					</option>
					<option value="high" tal:attributes="selected python:item.priority == 'high'">
                        <tal:span i18n:translate="priority_high_risk">high priority risk</tal:span>
					</option>
				</select> .
                <em tal:condition="python:request.get('errors', {}).get('priority')" class="validation warning message" data-validate-constraint="required">This value is required.</em>
			</label>
			<button class="iconified icon-trash float-after remove-clone">Remove risk</button>
        </fieldset>

		<fieldset class="risk-set clone" tal:condition="not:risks">
            <fieldset class="vertical">
			    <textarea autofocus required name="risk.description:utf8:ustring:records" placeholder="Description of risk 1" id="description-1" cols="30" rows="6" class="description"></textarea>
                <textarea name="risk.comment:utf8:ustring:records" class="span-15" rows="5"
                    placeholder="Please leave any comments you may have on the question above in this field. These comments will be used in the action plan."
                        i18n:attributes="placeholder label_comment"></textarea>
            </fieldset>
			<label class="priority">This is a
                <select name="risk.priority:utf8:ustring:records">
					<option value="low">
                        <tal:span i18n:translate="priority_low_risk">low priority risk</tal:span>
					</option>
					<option value="medium">
                        <tal:span i18n:translate="priority_medium_risk">medium priority risk</tal:span>
					</option>
					<option value="high">
                        <tal:span i18n:translate="priority_high_risk">high priority risk</tal:span>
					</option>
				</select> .
                <em tal:condition="python:request.get('errors', {}).get('priority')" class="validation warning message" data-validate-constraint="required">This value is required.</em>
			</label>
			<button class="iconified icon-trash float-after remove-clone">Remove risk</button>
		</fieldset>
	</fieldset>

    <p class="buttons pat-button-bar">
        <button id="clone-set-1" type="button" i18n:translate="label_add_risk" class="pat-button icon-plus-circle add-clone">Add risk</button>
        <button type="submit" name="next" value="next" i18n:translate="label_skip_to_action_plan" class="float-after pat-button icon-angle-circled-right">Save and continue to action plan</button>
    </p>
    </form>

    <fieldset class="risk-set" id="risk-template" hidden>
        <h2>Risk #{1}</h2>
        <fieldset class="vertical">
            <textarea autofocus required name="risk.description:utf8:ustring:records" placeholder="Description of risk #{1}" id="description-#{1}" cols="30" rows="6" class="description"></textarea>
            <textarea name="risk.comment:utf8:ustring:records" class="span-15" rows="5"
                placeholder="Please leave any comments you may have on the question above in this field. These comments will be used in the action plan."
                i18n:attributes="placeholder label_comment"></textarea>
        </fieldset>
        <label class="priority">This is a
            <select name="risk.priority:utf8:ustring:records">
                <option value="low">
                    <tal:span i18n:translate="priority_low_risk">low priority risk</tal:span>
                </option>
                <option value="medium">
                    <tal:span i18n:translate="priority_medium_risk">medium priority risk</tal:span>
                </option>
                <option value="high">
                    <tal:span i18n:translate="priority_high_risk">high priority risk</tal:span>
                </option>
            </select> .
        </label>
        <button class="iconified icon-trash float-after remove-clone">Remove risk</button>
    </fieldset>
</article>
</metal:slot>
</body>
</html>

